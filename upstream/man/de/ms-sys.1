.\"                                      Hey, EMACS: -*- nroff -*-
.\" First parameter, NAME, should be all caps
.\" Second parameter, SECTION, should be 1-8, maybe w/ subsection
.\" other parameters are allowed: see man(7), man(1)
.TH MS-SYS 1 "April 17, 2020"
.\" Please adjust this date whenever revising the manpage.
.\"
.\" Some roff macros, for reference:
.\" .nh        disable hyphenation
.\" .hy        enable hyphenation
.\" .ad l      left justify
.\" .ad b      justify to both left and right margins
.\" .nf        disable filling
.\" .fi        enable filling
.\" .br        insert line break
.\" .sp <n>    insert n+1 empty lines
.\" for manpage-specific macros, see man(7)
.SH "BEZEICHNUNG"
ms-sys \- schreibt einen Microsoft Bootblock
.SH "\[:U]BERSICHT"
.B ms-sys
.RI "[Optionen] [Ger\[:a]t]"
.SH "BESCHREIBUNG"
\fBms-sys\fP ist f\[:u]r das Schreiben von Microsoft kompatiblen Bootrecords.
.SH "OPTIONEN"
Eine Zusammenfassung der Optionen ist unten aufgef\[:u]hrt.
.TP
.B \-1, \-\-fat12
Schreibt einen FAT12 Disketten Bootrecord aufs Ger\[:a]t.
.TP
.B \-2, \-\-fat32nt5
Schreibt einen FAT32 Partition NT5.0 (NTLDR) Bootrecord aufs Ger\[:a]t.
.TP
.B \-8, \-\-fat32nt6
Schreibt einen FAT32 Partition NT6.0 (BOOTMGR) Bootrecord aufs Ger\[:a]t.
.TP
.B \-x, \-\-exfatnt6
Schreibt einen EXFAT Partition NT6.0 (BOOTMGR) Bootrecord aufs Ger\[:a]t.
.TP
.B \-e, \-\-fat32pe
Schreibt einen FAT32 Partition PE Bootrecord aufs Ger\[:a]t, 
f\[:u]r USB Installation und Wiederherstellung.
.TP
.B \-3, \-\-fat32
Schreibt einen FAT32 Partition DOS (Win9x) Bootrecord aufs Ger\[:a]t, 
.TP
.B \-4, \-\-fat32free
Schreibt einen FAT32 Partition FreeDOS Bootrecord aufs Ger\[:a]t, 
.TP
.B \-5, \-\-fat16free
Schreibt einen FAT16 Partition  Bootrecord aufs Ger\[:a]t, 
.TP
.B \-6, \-\-fat16
Schreibt einen FAT16 Partition DOS (Win9x) Bootrecord aufs Ger\[:a]t, 
.TP
.B \-n, \-\-ntfs
Schreibt einen NTFS Partition Windows 7 Bootrecord aufs Ger\[:a]t.
Diese Funktionalit\[:a]t sollte als experimentell angesehen werden und 
ist wahrscheinlich von keinem praktischen Nutzen.
.TP
.B \-o, \-\-fat16ros
Schreibt einen FAT16 Partition ReactOS Bootrecord aufs Ger\[:a]t.
.TP
.B \-c, \-\-fat32ros
Schreibt einen FAT32 Partition ReactOS Bootrecord aufs Ger\[:a]t.
.TP
.B \-q, \-\-fat32kos
Schreibt einen FAT32 Partition KolibriOS Bootrecord aufs Ger\[:a]t.
.TP
.B \-l, \-\-wipelabel
Entfernt Volumenlabel im Bootrecord.
.TP
.B \-p, \-\-partition
.\" wrong hyphenation Laufwerkskennung
Schreibt Partitions-Info (versteckte Sektoren, K\[:o]pfe und 
Laufwerkskennung) in Bootrecord.
Dies k\[:o]nnte auf einigen Partitionen erforderlich sein, je nach 
verwendetem Programm, mit dem das Dateisystem erstellt wurde.
.TP
.B \-H <n>, \-\-heads <n>
Anzahl der K\[:o]pfe, wenn -p Option verwendet wird.
.TP
.B \-O <s>, \-\-writeoem <s>
Schreibt OEM ID <s> zum Dateisystem.
.TP
.B \-S <x>, \-\-writewds <x>
Schreibt hexadezimal <x> als Windows Platten-Signatur zum MBR.
.TP
.B \-7, \-\-mbr7
Schreibt einen Windows 7 Master-Bootrecord aufs Ger\[:a]t.
Dies \[:a]ndert die Windows Platten-Signatur nicht (Bytes 01b8-01bd).
Dieser MBR wird bestimmte Partitionstypen jenseits der Zylindergrenze 
1024 booten mittels LBA-Adressierung.
.TP
.B \-i, \-\-mbrvista
Schreibt einen Windows Vista Master-Bootrecord aufs Ger\[:a]t.
Dies \[:a]ndert die Windows Platten-Signatur nicht (Bytes 01b8-01bd).
Dieser MBR wird bestimmte Partitionstypen jenseits der Zylindergrenze 
1024 booten mittels LBA-Adressierung.
.TP
.B \-m, \-\-mbr
Schreibt einen Windows 2000/XP/2003 Master-Bootrecord aufs Ger\[:a]t.
Dies \[:a]ndert die Windows Platten-Signatur nicht (Bytes 01b8-01bd).
Dieser MBR wird bestimmte Partitionstypen jenseits der Zylindergrenze 
1024 booten mittels LBA-Adressierung.
.TP
.B \-9, \-\-mbr95b
Schreibt einen Windows 95B/98/98SE/ME Master-Bootrecord aufs Ger\[:a]t.
Dies \[:a]ndert weder die Windows Platten-Signatur (Bytes 01b8-01bd) noch
das Boot-Laufwerk und die Zeit (Bytes 00da-00df).
Dieser MBR wird Partitionstypen 0c and 0e jenseits der Zylindergrenze 
1024 booten mittels LBA-Adressierung.
.TP
.B \-d, \-\-mbrdos
Schreibt einen DOS/Windows NT Master-Bootrecord aufs Ger\[:a]t.
Dies \[:a]ndert die Windows Platten-Signatur nicht (Bytes 01b8-01bd).
Dieser MBR wird nicht jenseits der Zylindergrenze 1024 booten 
da er die LBA-Adressierung nicht unterst\[:u]tzt.
.TP
.B \-s, \-\-mbrsyslinux
Schreibt einen Syslinux Master-Bootrecord aufs Ger\[:a]t.
Dies \[:a]ndert die Windows Platten-Signatur nicht (Bytes 01b8-01bd).
Dieser MBR wird jeden Partitionstypen jenseits der Zylindergrenze 
1024 booten mittels LBA-Adressierung.
.TP
.B \-t, \-\-mbrgptsyslinux
Schreibt einen GPL Syslinux GPT Master-Bootrecord aufs Ger\[:a]t.
Dieser MBR wird booten von einer GUID-Partitionstabelle.
.TP
.B \-a, \-\-mbrreactos
Schreibt einen ReactOS Master-Bootrecord aufs Ger\[:a]t.
.TP
.B \-k, \-\-mbrkolibrios
Schreibt einen KolibriOS Master-Bootrecord aufs Ger\[:a]t.
.TP
.B \-r, \-\-mbrrufus
Schreibt einen Rufus Master-Bootrecord aufs Ger\[:a]t.
.TP
.B \-g, \-\-mbrgrub4dos
Schreibt einen Grub4Dos Master-Bootrecord aufs Ger\[:a]t.
.TP
.B \-b, \-\-mbrgrub2
Schreibt einen Grub 2 Master-Bootrecord aufs Ger\[:a]t.
.TP
.B \-z, \-\-mbrzero
Schreibt einen leeren (augenullten, nicht startbaren) Master-Bootrecord aufs Ger\[:a]t.
Nullt alle Bytes mit Ausnahme der Partitionstabelle und
der Signatur Id (Bytes 01BE-01FF).
\[:A]hnlich wie ein leere DOS-Partitionstabelle, die fdisk erstellt.
.TP
.B \-f, \-\-force
Schreiben des Bootrecords erzwingen.
.TP
.B \-h, \-\-help
Zeigt Zusammenfassung der Optionen.
.TP
.B \-v, \-\-version
Zeigt Programmversion.
.TP
.B \-w, \-\-write
Schreibt automatisch gew\[:a]hlten Bootrecord aufs Ger\[:a]t.
.P
ms-sys ohne Optionen wird eine einfache Diagnose an 
dem angegebenen Ger\[:a]t durchf\[:u]hren.
.br
.SH "NOTIZEN"
.P
Beim Schreiben von EXFAT-Partitionsinformationen wird die Anzahl der K\[:o]pfe nicht verwendet
und die Wipelabel-Funktion wird auch nicht unterst\[:u]tzt weil diese nicht in der gespeichert
sind BIOS-Parameterblock oder irgendwo im Bootsektor. Die zugeh\[:o]rigen Schalter werden bei
Angabe ignoriert.
.sp
Beim Schreiben von NTFS-Partitionsinformationen die ID des physischen Laufwerks wird nicht
verwende und das Wischetikett Funktion wird nicht unterst\[:u]tzt aus den oben genannten Gr\[:u]nden.
Die Schalter werden ignoriert.
.sp
Die Funktion zum Schreiben von OEM ID wird nur f\[:u]r unterst\[:u]tzt FAT12/16/32 Dateisysteme
und dies zu \[:a]ndern Wert auf NTFS- oder EXFAT-Volumes f\[:u]hrt zu einer nicht bereitstellbaren
Partition.
.br
.SH "BEISPIELE"
.P
Bitte beachten Sie, dass Windows ME nicht sinnvoll f\[:u]r die Herstellung von
eigenst\[:a]ndig bootf\[:a]higen Disketten ist. 
Win9x und DOS jedoch funktionieren gut mit den ersten beiden Beispielen.
.P
.B Erstellen einer bootf\[:a]higen 1,68 MB Diskette 
.TP
Dieses Beispiel geht davon aus, dass Sie Ihre Windows-Installation in /dosc eingeh\[:a]ngt haben und
auch mtools und fdformat installiert sind.
.P
fdformat /dev/fd0u1680
.br
mformat a:
.br
ms-sys -w /dev/fd0
.br
mcopy /dosc/io.sys a:
.br
mcopy /dosc/msdos.sys a:
.br
mcopy /dosc/command.com a:
.P
.B Erstellen eines bootf\[:a]higen 2.8 MB Disketten-Abbilds f\[:u]r eine El-Torito bootf\[:a]hige CD.
.P
dd if=/dev/zero of=floppy288.img bs=1024 count=2880
.br
/sbin/mkdosfs floppy288.img
.br
ms-sys -1 -f floppy288.img
.br
su
.br
mount -o loop floppy288.img /mnt
.br
cp msdos.sys /mnt/
.br
cp io.sys /mnt/
.br
cp command.com /mnt/
.br
(es k\[:o]nnte auch eine gute Idee sein, eine config.sys und autoexec.bat mit CD-ROM-Unterst\[:u]tzung hinzuf\[:u]gen)
.br
umount /mnt
.br
exit
.br
cp floppy288.img cd-files/boot.img
.br
mkisofs -b boot.img -c boot.cat -o cdimage.iso cd\-files
.br
(Brennen Sie die Datei cdimage.iso auf CD mit cdrecord oder einem anderen Programm)
.P
.B  Wiederherstellen einer Sicherung von Win9x oder Win ME auf einer neuen Festplatte
.P
Schritt 1, verwenden sie GNU parted um ihr FAT32-Partition und Dateisystem zu erstellen:
.P
parted (dann FAT32-Partition und Dateisystem erstellen)
.P
Schritt 2, schreiben des MBR:
.P
ms-sys -w /dev/hda
.P
Schritt 3, schreiben des FAT32 Partition Bootrecords:
.P
ms-sys -w /dev/hda1
.P
Schritt 4, einh\[:a]ngen des neuen Dateisystems:
.P
mount /dev/hda1 /mnt
.P
Schritt 5, Wiederherstellen ihres Backups
.P
cd /mnt; tar -xzvf /path/to/my_windows_backup_file.tgz
.br
.SH "UMGEBUNG"
Die Variablen LANG und LC_ALL haben die \[:u]bliche Bedeutung,
aber es sind nicht viele \[:U]bersetzungen vorhanden.
.br
.SH "FEHLER"
Es gab Berichte \[:u]ber nicht mehr bootbare FAT32-Partitionen erstellt mit
"mformat -F C:". Das Problem wurde auch auf f\[:u]r Partitionen gemeldet,
die mit mkdosfs und mkfs.vfat formatiert wurden. Eine Abhilfe ist, 
statt dessen GNU parted zu verwenden um die Partition zu erstellen.
Seit der Version 1.1.3 ms-sys hat den Schalter \-p, der dieses Problem beheben soll. 
Leider funktioniert mit Linux Kernel 2.6 weder die Option \-p noch GNU parted.
Eine einfache Abhilfe ist, ms-sys mit Linux Kernel 2.4 zu verwenden. 
Eine andere m\[:o]gliche Problemumgehung ist es, die Anzahl der K\[:o]pfe mit dem Schalter -H manuell einzustellen. 
Wenn das System von LILO gebootet wurde, kann die korrekte Anzahl der K\[:o]pfe
durch "lilo -T geom" ermittelt werden.
.P
Das Schreiben von NTFS Partition-Bootrecords hat wohl keinen praktischen Nutzen.
F\[:u]r Windows 7 wurde berichtet, dass das Ausf\[:u]hren von "sysprep", 
bevor Sie ein Abbild einer NTFS-Partition erstellen,
die aus diesem wiederhergestellte Partition bootf\[:a]hig macht.
.SH "AUTOREN"
.\" basiert auf englisher Manualseite MS-SYS Version 2.5.0 "September 25, 2005"
Die englischsprachige Handbuchseite wurde urspr\[:u]nglich von G\[:u]rkan Seng\[:u]n geschrieben 
und dann von Henrik Carlqvist bearbeitet. Er hat gr\[:o]\[ss]tenteils das Programm ms-sys geschrieben,
die Datei CONTRIBUTORS in dem Quellen-Archiv enth\[:a]lt eine
komplette Liste der Mitwirkenden.
.SH "SIEHE AUCH"
mformat(1)  fdformat(8)  mkdosfs(8)  mkisofs(8)  parted(8)
.\" .TH MS-SYS 1 "September 25, 2005"
.\" 
.\" FOR EMACS
.\" Local Variables:
.\" coding: utf-8
.\" ispell-local-dictionary: "german8"
.\" eval:(make-local-variable 'compile-command)
.\" eval:(setq compile-command (concat "echo  "(buffer-file-name) ))
.\" eval:(make-local-variable 'time-stamp-start)
.\" eval:(setq time-stamp-start "^\.TH MS-SYS 1 \"")
.\" eval:(make-local-variable 'time-stamp-format)
.\" eval:(setq time-stamp-format "%:b %02d, %04y")
.\" End:
.\" 
